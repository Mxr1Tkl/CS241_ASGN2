<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity6">
    <head>
        <meta name="viewpoint" content="width=device-width, initial-scale=1.0, charset=UTF-8"/>
        <title>Profile</title>
        <link href="@{/css/style.css}" rel="stylesheet"/>
        <link th:href="@{/css/profile.css}" rel="stylesheet"/>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>

    </head>
    <body>
        <div class="geometric-bg"></div>

        <!-- Header -->
        <header>
            <nav>
                <a th:href="@{/home}" class="logo">
                    <svg viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg">
                        <defs>
                            <linearGradient id="logoGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:#667eea;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#764ba2;stop-opacity:1" />
                            </linearGradient>
                        </defs>
                        <circle cx="20" cy="20" r="18" fill="none" stroke="url(#logoGradient)" stroke-width="2"/>
                        <circle cx="20" cy="20" r="14" fill="none" stroke="url(#logoGradient)" stroke-width="1.5" opacity="0.7"/>
                        <circle cx="20" cy="20" r="10" fill="none" stroke="url(#logoGradient)" stroke-width="1" opacity="0.5"/>
                        <circle cx="20" cy="20" r="6" fill="none" stroke="url(#logoGradient)" stroke-width="0.5" opacity="0.3"/>
                        <circle cx="20" cy="20" r="3" fill="url(#logoGradient)"/>
                    </svg>
                    <span class="logo-text">Circle of knowledge</span>
                </a>
                <div class="menu-toggle" onclick="toggleMenu()">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
                <input class="search-button1" type="search" placeholder="Search..." value="Search"/><a href="@{/search_result}" class="search-button">üîç</a>
                <div class="navbar-brand d-flex align-items-center">
                    <a href="#">
                        <img src="https://static.vecteezy.com/system/resources/thumbnails/001/505/138/small_2x/notification-bell-icon-free-vector.jpg" 
                         alt="Notification" width="45" height="45" class="rounded me-2"/>
                    </a>
                    <a th:href="@{/profile}">
                        <img src="https://cdn-icons-png.flaticon.com/512/7077/7077313.png" 
                         alt="Profile" width="50" height="50" class="rounded"/>
                    </a>
                    <div sec:authorize="isAuthenticated()" class="logo-text">
                        Welcome <b><span sec:authentication="principal.username">Username</span></b>
                        &nbsp;
                        <form th:action="@{/logout}" method="post">
                            <input type="submit" value="Logout" />
                        </form>
                    </div>
                </div>
                <div>
                    <ul class="nav-links">
                        <li><a th:href="@{/home}" class="nav-link">Home</a></li>
                        <li><a th:href="@{/archive}" class="nav-link">Archive</a></li>
                        <li><a th:href="@{/resources}" class="nav-link">Resources</a></li>
                        <li><a th:href="@{/forum}" class="nav-link">Discussion Forum</a></li>
                    </ul>
                </div>
            </nav>
        </header>
        <main>
            <!-- Page -->
            <div class="page">
              <div class="profile-card" role="region" aria-label="Profile management">

                <!-- left column -->
                <aside class="profile-side" aria-hidden="false">
                  <div class="avatar-wrap">
                    <!-- show user avatar; replace src with th:src to bind server-side -->
                    <img id="avatarPreview" class="avatar" src="https://images.unsplash.com/photo-1544005313-94ddf0286df2?w=800&q=60" alt="User avatar">

                    <div class="upload-row">
                      <label class="btn-upload" for="avatarInput">Upload</label>
                      <input id="avatarInput" class="file-input" type="file" accept="image/*">
                      <button class="btn-remove" id="removeAvatarBtn" type="button" title="Remove avatar">Remove</button>
                    </div>

                    <div class="quick-meta">
                      <h3 id="displayName">Jane Doe</h3>
                      <p class="muted" id="displayHandle">@janedoe</p>
                    </div>
                  </div>

                  <div class="section">
                    <h2>Preferences</h2>
                    <div class="form-row">
                      <label for="lang">Language</label>
                      <select id="lang">
                        <option>English</option>
                        <option>Fijian</option>
                        <option>Other</option>
                      </select>
                    </div>

                    <div class="form-row">
                      <label for="visibility">Profile visibility</label>
                      <select id="visibility">
                        <option>Public</option>
                        <option>Members only</option>
                        <option>Private</option>
                      </select>
                      <p class="muted">Control who can see your profile and posts.</p>
                    </div>
                  </div>
                </aside>

                <!-- right column -->
                <div class="profile-main">
                  <form id="profileForm" class="section" th:action="@{/profile/update}" method="post" enctype="multipart/form-data">
                    <h2>Basic Information</h2>

                    <div class="field-grid">
                      <div class="form-row">
                        <label for="fullName">Full name</label>
                        <input id="fullName" name="fullName" type="text" th:field="*{fullName}" value="Jane Doe" required>
                      </div>

                      <div class="form-row">
                        <label for="username">Username</label>
                        <input id="username" name="username" type="text" th:field="*{username}" value="janedoe" required>
                      </div>
                    </div>

                    <div class="form-row">
                      <label for="email">Email address</label>
                      <input id="email" name="email" type="email" th:field="*{email}" value="jane@example.com" required>
                    </div>

                    <div class="form-row">
                      <label for="bio">Bio</label>
                      <textarea id="bio" name="bio" th:field="*{bio}" placeholder="Write a short bio...">Community educator and knowledge keeper.</textarea>
                    </div>

                    <div class="form-actions">
                      <button type="submit" class="btn-save">Save changes</button>
                      <button type="button" class="btn-cancel" id="discardBtn">Discard</button>
                    </div>
                  </form>

                  <div class="section">
                    <h2>Change password</h2>
                    <form id="passwordForm" th:action="@{/profile/password}" method="post">
                      <div class="form-row">
                        <label for="currentPassword">Current password</label>
                        <input id="currentPassword" name="currentPassword" type="password" required>
                      </div>
                      <div class="field-grid">
                        <div class="form-row">
                          <label for="newPassword">New password</label>
                          <input id="newPassword" name="newPassword" type="password" required>
                        </div>
                        <div class="form-row">
                          <label for="confirmPassword">Confirm password</label>
                          <input id="confirmPassword" name="confirmPassword" type="password" required>
                        </div>
                      </div>

                      <div class="form-actions">
                        <button type="submit" class="btn-save">Update password</button>
                        <button type="button" class="btn-cancel" id="cancelPassBtn">Cancel</button>
                      </div>
                    </form>
                  </div>

                  <div class="section delete-account">
                    <h2 class="danger">Danger zone</h2>
                    <p class="muted">Deleting your account is permanent. Your profile and posts will be removed.</p>
                    <div class="form-actions">
                      <form id="deleteForm" th:action="@{/profile/delete}" method="post" onsubmit="return confirm('Are you sure? This action cannot be undone.');">
                        <button type="submit" class="btn-remove">Delete account</button>
                      </form>
                    </div>
                  </div>
                </div>
              </div>
            </div>
        </main>

        <!-- Footer -->
        <footer>
            <div class="footer-content">
                <div class="footer-links">
                    <a href="#privacy">Privacy Policy</a>
                    <a href="#terms">Terms of Service</a>
                    <a href="#support">Support</a>
                </div>
                <div class="copyright">
                    <p>&copy; 2025 Circle of Knowledge. All rights reserved. Nurturing Indigenous Knowlege, one step at a time. 
                            </div>
            </div>
        </footer>
    <script src="profile.js"></script>
    </body>
</html>